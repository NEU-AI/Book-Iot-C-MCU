# 高-中-低配

就在项目按序就班是开展过程中，突然有一天客户过来说要求对需求进行下增补。客户为了适配不同的市场，希望将当前设计扩展出高配、中配、低配三款不同的产品，其主要区别在于人机交互上。最重要的一点，客户要求使用一套代码实现。

* 低配：支持LED显示
* 中配：支持数码管显示，用数码管显示参数配置和当前脉搏，需增加按键支持相关配置
* 高配：支持LCD/OLED，用显示屏代替数码管，按键功能不变，增加波形显示功能

产品设计中更改设计是一件很头痛的事情，不过因为我们采用的程序架构是`时间片轮询架构`，所以至少目前的修改对项目整体影响不大。我们需要修改的程序单元有：`按键检测部分`和`状态显示部分`，其中按键检测部分需要检测多个按键，状态显示部分需要设计不同的显示程序，根据配置选择不同的函数。这里所说的配置是指硬件或软件上的配置，例如硬件拉高某个管脚，软件配置某个寄存器，表示设备对不同外设的支持。

## 配置识别

如何高速程序当前的硬件配置？从实现上有两种方法：硬件、软件。使用硬件可通过配置某几个IO口，以标识不同的外设组合，方法比较简单，但是生产时的硬件兼容性交差。软件方法可在生产过程中配置Flash中的某些标志位，标志所支持的不同外设组合，优点是灵活，缺点是生产过程会增加配置步骤。

无论采用哪种方法，其本质原理是一样的即根据某些标志位，在时间片轮询机制中选择不同的函数调用。

## 数码管显示

//todo

## LCD屏支持

//todo
